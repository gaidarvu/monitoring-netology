1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя платформу для вычислений с выдачей текстовых отчётов, которые сохраняются на диск. 
Взаимодействие с платформой осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы выведите в мониторинг и почему?

# Минимальный набор метрик для мониторинга проекта  
Мне кажется, что нужно отслеживать базовые вещи, которые помогут понять, что происходит с системой. Например:  

**CPU**
  - Нагрузка на проц в процентах.  
  - средняя нагрузка на процессор за разный период времени. 
  - Может быть, стоит смотреть температуру процессора, чтобы не перегревался.

**RAM**:  
  - Сколько памяти занято.  
  - Если памяти не хватает и используется swap, надо понять, как часто к нему обращаются.

**Диск**:  
  - Сколько места занято.
  - Мониторинг inode, если пачками сохраняются мелкие файлы.

**Сеть**:
  - Общая нагрузка на сеть
  - Сколько запросов приходит по HTTP за определенный промежуток времени
  - Какие коды ответа возвращает сервер

2. Менеджер продукта, посмотрев на ваши метрики, сказал, что ему непонятно, что такое RAM/inodes/CPUla. Также он сказал, что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы можете ему предложить?

## Предложение для менеджера продукта  
  Думаю, что эти показатели помогут менеджеру понять, как платформа выполняет свои обязательства перед клиентами:

**SLA/SLI/SLO**:  
  - SLA - доступность сервиса, например, сервис доступен определённое количество времени, например, 99% успешных запросов.  
  - SLI - метрики уровня сервиса, такие как:  
    - Сколько времени уходит на обработку запросов.  
    - Сколько запросов успешные (например, с кодом 2xx).  
    - Сколько времени уходит на вычисления.  
  - SLO - целевые значения, которых мы хотим достичь, например, чтобы успешных запросов было 99.5%.  

**Бизнес-метрики**:  
  - Сколько задач удалось завершить.  
  - Сколько времени в среднем занимает выполнение одной задачи.  
  - Сколько ошибок произошло (если такое возможно отследить).  
  Наверное, это поможет менеджеру понять, как хорошо мы справляемся с работой.

3. Вашей DevOps-команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики, в свою очередь, хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, чтобы разработчики получали ошибки приложения?

## Решение для логирования при ограниченном бюджете  
Если денег на централизованное логирование нет, то наверное можно сделать что-то простое.  

**Локальные логи**:  
  - Настроить так, чтобы логи периодически удалялись (например, через logrotate).  
  - Хранить логи прямо на серверах.  
  - Дать доступ разработчикам к серверам или придумать, как им отправлять логи.  

**Уведомления об ошибках**:  
  - Настроить алерты в системе мониторинга Prometheus + Alertmanager, чтобы видеть, когда появляются ошибки.

**Отправка логов**:  
  - Сделать скрипт, который ищет ошибки и отправляет уведомления по почте или в мессенджеры, например в телеграм

4. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA = 99% по http-кодам ответов. 
Этот параметр вычисляется по формуле: summ_2xx_requests/summ_all_requests. Он не поднимается выше 70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

## Ошибка в SLA вычислениях  

SLA = summ_2xx_requests/summ_all_requests

Если SLA ниже 70%, но при этом ошибок 4xx и 5xx нет, скорее всего есть много запросов, которые возвращают коды 1xx или 3xx. Эти коды не считаются успешными, но включаются в общее число запросов.  
Нужно добавить их в числитель:

SLA = (summ_2xx_requests + summ_1xx_requests + summ_3xx_requests)/summ_all_requests

А так-же будет полезным убедиться, что данные метрик собираются и обрабатываются правильно.  
